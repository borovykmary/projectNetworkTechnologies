{"ast":null,"code":"var _jsxFileName = \"/Users/marynaborovyk/Desktop/semestr-4/Network_Technologies/Project/projectNetworkTechnologies/frontend_nt/library-webapp/src/login-form/Login-form.tsx\",\n  _s = $RefreshSig$();\nimport \"./Login-form.css\";\nimport { Button, TextField } from \"@mui/material\";\nimport LoginIcon from \"@mui/icons-material/Login\";\nimport { Formik } from \"formik\";\nimport { useCallback, useMemo } from \"react\";\nimport * as yup from \"yup\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useApi } from \"../api/ApiProvide\";\nimport { useCookies } from \"react-cookie\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction LoginForm() {\n  _s();\n  const [cookies, setCookie] = useCookies(['token']);\n  const initialValues = {\n    username: \"\",\n    password: \"\"\n  };\n  const navigate = useNavigate();\n  const apiClient = useApi();\n  const submit = useCallback((values, formik) => {\n    formik.resetForm();\n    apiClient.login(values).then(response => {\n      console.log(response);\n      if (!response.success) {\n        console.log(\"Login failed\");\n        return;\n      }\n      setCookie(\"token\", response.data.token, {\n        path: \"/\"\n      });\n      const jwt_decode = require('jwt-decode');\n      const decodedToken = jwt_decode(response.data.token);\n      const userRole = decodedToken.role;\n      const userId = decodedToken.id;\n      if (userRole === \"ADMIN\") {\n        navigate(\"/admin\");\n      }\n    });\n    navigate(\"/home\");\n  }, [navigate, setCookie]);\n  const validationSchema = useMemo(() => yup.object().shape({\n    username: yup.string().required(\"Username is required\"),\n    password: yup.string().required(\"Password is required\").min(8, \"Password must be at least 8 characters\")\n  }), []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"login-page\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"login-content\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"login-text\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Log In\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Welcome back, dear user!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Formik, {\n        initialValues: initialValues,\n        onSubmit: submit,\n        validationSchema: validationSchema,\n        validateOnChange: true,\n        validateOnBlur: true,\n        children: formik => /*#__PURE__*/_jsxDEV(\"form\", {\n          id: \"loginForm\",\n          className: \"Login-form\",\n          onSubmit: formik.handleSubmit,\n          noValidate: true,\n          children: [/*#__PURE__*/_jsxDEV(TextField, {\n            id: \"username\",\n            label: \"Username\",\n            variant: \"outlined\",\n            name: \"username\",\n            onChange: formik.handleChange,\n            onBlur: formik.handleBlur,\n            error: formik.touched.username && !!formik.errors.username,\n            helperText: formik.touched.username && formik.errors.username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            id: \"password\",\n            label: \"Password\",\n            variant: \"outlined\",\n            type: \"password\",\n            onChange: formik.handleChange,\n            onBlur: formik.handleBlur,\n            error: formik.touched.password && !!formik.errors.password,\n            helperText: formik.touched.password && formik.errors.password\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            type: \"submit\",\n            form: \"loginForm\",\n            disabled: !formik.isValid && formik.dirty,\n            endIcon: /*#__PURE__*/_jsxDEV(LoginIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 110,\n              columnNumber: 26\n            }, this),\n            children: [\" \", \"LogIn\", \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 5\n  }, this);\n}\n_s(LoginForm, \"ZjIpqdoEpPc3atvY3+eDNG9NGW8=\", false, function () {\n  return [useCookies, useNavigate, useApi];\n});\n_c = LoginForm;\nexport default LoginForm;\nvar _c;\n$RefreshReg$(_c, \"LoginForm\");","map":{"version":3,"names":["Button","TextField","LoginIcon","Formik","useCallback","useMemo","yup","useNavigate","useApi","useCookies","jsxDEV","_jsxDEV","LoginForm","_s","cookies","setCookie","initialValues","username","password","navigate","apiClient","submit","values","formik","resetForm","login","then","response","console","log","success","data","token","path","jwt_decode","require","decodedToken","userRole","role","userId","id","validationSchema","object","shape","string","required","min","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","validateOnChange","validateOnBlur","handleSubmit","noValidate","label","variant","name","onChange","handleChange","onBlur","handleBlur","error","touched","errors","helperText","type","form","disabled","isValid","dirty","endIcon","_c","$RefreshReg$"],"sources":["/Users/marynaborovyk/Desktop/semestr-4/Network_Technologies/Project/projectNetworkTechnologies/frontend_nt/library-webapp/src/login-form/Login-form.tsx"],"sourcesContent":["import \"./Login-form.css\";\nimport { Button, TextField } from \"@mui/material\";\nimport LoginIcon from \"@mui/icons-material/Login\";\nimport { Formik } from \"formik\";\nimport { useCallback, useMemo } from \"react\";\nimport * as yup from \"yup\";\nimport { useNavigate } from \"react-router-dom\";\nimport bookIcon from \"/Users/marynaborovyk/Desktop/semestr-4/Network_Technologies/Project/projectNetworkTechnologies/frontend_nt/library-webapp/src/res/bookicon.svg\";\nimport axios from \"axios\";\nimport { useApi } from \"../api/ApiProvide\";\nimport {useCookies} from \"react-cookie\";\nimport jwt_decode from \"jwt-decode\";\n\ntype FormValues = {\n  username: string;\n  password: string;\n};\n\nfunction LoginForm() {\n  const [cookies, setCookie] = useCookies(['token']);\n  const initialValues = { username: \"\", password: \"\" };\n  const navigate = useNavigate();\n  const apiClient = useApi();\n\n  const submit = useCallback(\n  (values: FormValues, formik: any) => {\n    formik.resetForm();\n\n    apiClient.login(values).then((response) => {\n      console.log(response);\n      if (!response.success) {\n        console.log(\"Login failed\");\n        return;\n      }\n        setCookie(\"token\", response.data.token, { path: \"/\"});\n\n        const jwt_decode = require('jwt-decode');\n        const decodedToken = jwt_decode(response.data.token);\n        const userRole = decodedToken.role;\n        const userId = decodedToken.id;\n\n        if (userRole === \"ADMIN\") {\n          navigate(\"/admin\");\n        }\n    });\n    navigate(\"/home\");\n  },\n  [navigate, setCookie],\n);\n\n  const validationSchema = useMemo(\n    () =>\n      yup.object().shape({\n        username: yup.string().required(\"Username is required\"),\n        password: yup\n          .string()\n          .required(\"Password is required\")\n          .min(8, \"Password must be at least 8 characters\"),\n      }),\n    [],\n  );\n\n  return (\n    <div className=\"login-page\">\n      <div className=\"login-content\">\n        <div className=\"login-text\">\n          <h1>Log In</h1>\n          <p>Welcome back, dear user!</p>\n        </div>\n\n        <Formik\n          initialValues={initialValues}\n          onSubmit={submit}\n          validationSchema={validationSchema}\n          validateOnChange\n          validateOnBlur\n        >\n          {(formik: any) => (\n            <form\n              id=\"loginForm\"\n              className=\"Login-form\"\n              onSubmit={formik.handleSubmit}\n              noValidate\n            >\n              <TextField\n                id=\"username\"\n                label=\"Username\"\n                variant=\"outlined\"\n                name=\"username\"\n                onChange={formik.handleChange}\n                onBlur={formik.handleBlur}\n                error={formik.touched.username && !!formik.errors.username}\n                helperText={formik.touched.username && formik.errors.username}\n              />\n              <TextField\n                id=\"password\"\n                label=\"Password\"\n                variant=\"outlined\"\n                type=\"password\"\n                onChange={formik.handleChange}\n                onBlur={formik.handleBlur}\n                error={formik.touched.password && !!formik.errors.password}\n                helperText={formik.touched.password && formik.errors.password}\n              />\n              <Button\n                variant=\"contained\"\n                type=\"submit\"\n                form=\"loginForm\"\n                disabled={!formik.isValid && formik.dirty}\n                endIcon={<LoginIcon />}\n              >\n                {\" \"}\n                LogIn{\" \"}\n              </Button>\n            </form>\n          )}\n        </Formik>\n      </div>\n    </div>\n  );\n}\n\nexport default LoginForm;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}